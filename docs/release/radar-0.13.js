function radar_visualization(t){if(t.svg_id=t.svg||"radar",t.width=t.width||1450,t.height=t.height||1e3,t.colors="colors"in t?t.colors:{background:"#fff",grid:"#dddde0",inactive:"#ddd"},t.print_layout=!("print_layout"in t)||t.print_layout,t.links_in_new_tabs=!("links_in_new_tabs"in t)||t.links_in_new_tabs,t.repo_url=t.repo_url||"#",t.print_ring_descriptions_table="print_ring_descriptions_table"in t&&t.print_ring_descriptions_table,!t.legend_offset){t.legend_offset=[];var e=t.quadrants.length;if(4===e)t.legend_offset=[{x:450,y:90},{x:-675,y:90},{x:-675,y:-310},{x:450,y:-310}];else for(var n=0;n<e;n++){var r=-Math.PI+(n+.5)*(2*Math.PI/e);t.legend_offset.push({x:Math.round(500*Math.cos(r)),y:Math.round(500*Math.sin(r))})}}if(t.title_offset=t.title_offset||{x:-675,y:-420},t.footer_offset=t.footer_offset||{x:-155,y:450},t.legend_column_width=t.legend_column_width||140,t.legend_line_height=t.legend_line_height||10,!t.quadrants||t.quadrants.length<2||t.quadrants.length>8)throw new Error("Number of quadrants must be between 2 and 8 (found: "+(t.quadrants?t.quadrants.length:0)+")");if(!t.rings||t.rings.length<4||t.rings.length>8)throw new Error("Number of rings must be between 4 and 8 (found: "+(t.rings?t.rings.length:0)+")");for(n=0;n<t.entries.length;n++){if((w=t.entries[n]).quadrant<0||w.quadrant>=t.quadrants.length)throw new Error("Entry '"+w.label+"' has invalid quadrant: "+w.quadrant+" (must be 0-"+(t.quadrants.length-1)+")");if(w.ring<0||w.ring>=t.rings.length)throw new Error("Entry '"+w.label+"' has invalid ring: "+w.ring+" (must be 0-"+(t.rings.length-1)+")")}var a=42;function l(){var t=1e4*Math.sin(a++);return t-Math.floor(t)}function o(t,e){return t+.5*(l()+l())*(e-t)}const i=[],s=t.quadrants.length,d=2/s;for(let t=0;t<s;t++){const e=t*d-1,n=(t+1)*d-1,r=-Math.PI+(t+.5)*d*Math.PI;i.push({radial_min:e,radial_max:n,factor_x:Math.cos(r),factor_y:Math.sin(r)})}const f=[],p=t.rings.length,c=[130,220,310,400];if(4===p)for(let t=0;t<4;t++)f.push({radius:c[t]});else for(let t=0;t<p;t++){const e=t/(p-1)*3,n=Math.floor(e);let r;r=n>=3?400:c[n]+(c[n+1]-c[n])*(e-n),f.push({radius:Math.round(r)})}function u(t){var e=t.x,n=t.y;return{t:Math.atan2(n,e),r:Math.sqrt(e*e+n*n)}}function y(t){return{x:t.r*Math.cos(t.t),y:t.r*Math.sin(t.t)}}function h(t,e,n){var r=Math.min(e,n),a=Math.max(e,n);return Math.min(Math.max(t,r),a)}function g(t,e,n){return{t:t.t,r:h(t.r,e,n)}}function _(t,e,n){return{x:h(t.x,e.x,n.x),y:h(t.y,e.y,n.y)}}function x(t,e){var n={t:i[t].radial_min*Math.PI,r:0===e?30:f[e-1].radius},r={t:i[t].radial_max*Math.PI,r:f[e].radius},a={x:15*i[t].factor_x,y:15*i[t].factor_y},s={x:f[f.length-1].radius*i[t].factor_x,y:f[f.length-1].radius*i[t].factor_y};return{clipx:function(t){var e=g(u(_(t,a,s)),n.r+15,r.r-15);return t.x=y(e).x,t.x},clipy:function(t){var e=g(u(_(t,a,s)),n.r+15,r.r-15);return t.y=y(e).y,t.y},random:function(){return y({t:(t=n.t,e=r.t,t+l()*(e-t)),r:o(n.r,r.r)});var t,e}}}for(n=0;n<t.entries.length;n++){(w=t.entries[n]).segment=x(w.quadrant,w.ring);var m=w.segment.random();w.x=m.x,w.y=m.y,w.color=w.active||t.print_layout?t.rings[w.ring].color:t.colors.inactive}var b=new Array(s);for(let t=0;t<s;t++){b[t]=new Array(p);for(var v=0;v<p;v++)b[t][v]=[]}for(n=0;n<t.entries.length;n++){var w;b[(w=t.entries[n]).quadrant][w.ring].push(w)}var M=1,k=[];if(4===s)k=[2,3,1,0];else{var q=Math.floor(s/2);for(n=0;n<s;n++)k.push((q+n)%s)}for(quadrant of k)for(v=0;v<p;v++){var z=b[quadrant][v];z.sort(function(t,e){return t.label.localeCompare(e.label)});for(n=0;n<z.length;n++)z[n].id=""+M++}function I(t,e){return"translate("+t+","+e+")"}t.scale=t.scale||1;var A=t.width*t.scale,B=t.height*t.scale,P=d3.select("svg#"+t.svg_id).style("background-color",t.colors.background).attr("width",A).attr("height",B),E=P.append("g");"zoomed_quadrant"in t?P.attr("viewBox",function(t){var e=f[f.length-1].radius;return[Math.max(0,i[t].factor_x*e)-(e+20),Math.max(0,i[t].factor_y*e)-(e+20),e+40,e+40].join(" ")}(t.zoomed_quadrant)):E.attr("transform",I(A/2,B/2).concat(`scale(${t.scale})`));var C=E.append("g");t.font_family=t.font_family||"Arial, Helvetica";var j=f[f.length-1].radius;for(n=0;n<s;n++){r=-Math.PI+2*n*Math.PI/s;C.append("line").attr("x1",0).attr("y1",0).attr("x2",j*Math.cos(r)).attr("y2",j*Math.sin(r)).style("stroke",t.colors.grid).style("stroke-width",1)}var L=C.append("defs").append("filter").attr("x",0).attr("y",0).attr("width",1).attr("height",1).attr("id","solid");L.append("feFlood").attr("flood-color","rgb(0, 0, 0, 0.8)"),L.append("feComposite").attr("in","SourceGraphic");for(n=0;n<f.length;n++)C.append("circle").attr("cx",0).attr("cy",0).attr("r",f[n].radius).style("fill","none").style("stroke",t.colors.grid).style("stroke-width",1),t.print_layout&&C.append("text").text(t.rings[n].name).attr("y",62-f[n].radius).attr("text-anchor","middle").style("fill",t.rings[n].color).style("opacity",.35).style("font-family",t.font_family).style("font-size","42px").style("font-weight","bold").style("pointer-events","none").style("user-select","none");function S(e,n,r,a=null,l=null){var o=p>=7?3:2,i=Math.ceil(p/o),s=n%i;const d=Math.floor(n/i)*r;let f=null==a?-16:a*t.legend_line_height;return s>0&&(f=f+36+l),I(t.legend_offset[e].x+d,t.legend_offset[e].y+f)}if(t.print_layout){E.append("a").attr("href",t.repo_url).attr("transform",I(t.title_offset.x,t.title_offset.y)).append("text").attr("class","hover-underline").text(t.title).style("font-family",t.font_family).style("font-size","30").style("font-weight","bold"),E.append("text").attr("transform",I(t.title_offset.x,t.title_offset.y+20)).text(t.date||"").style("font-family",t.font_family).style("font-size","14").style("fill","#999"),E.append("text").attr("transform",I(t.footer_offset.x,t.footer_offset.y)).text("▲ moved up     ▼ moved down     ★ new     ⬤ no change").attr("xml:space","preserve").style("font-family",t.font_family).style("font-size","12px");const e=E.append("g");for(let n=0;n<s;n++){e.append("text").attr("transform",I(t.legend_offset[n].x,t.legend_offset[n].y-45)).text(t.quadrants[n].name).style("font-family",t.font_family).style("font-size","18px").style("font-weight","bold");let r=0;var T=p>=7?3:2,N=Math.ceil(p/T);for(let a=0;a<p;a++)a%N===0&&(r=0),e.append("text").attr("transform",S(n,a,t.legend_column_width,null,r)).text(t.rings[a].name).style("font-family",t.font_family).style("font-size","12px").style("font-weight","bold").style("fill",t.rings[a].color),e.selectAll(".legend"+n+a).data(b[n][a]).enter().append("a").attr("href",function(t,e){return t.link?t.link:"#"}).attr("target",function(e,n){return e.link&&t.links_in_new_tabs?"_blank":null}).append("text").attr("transform",function(e,l){return S(n,a,t.legend_column_width,l,r)}).attr("class","legend"+n+a).attr("id",function(t,e){return"legendItem"+t.id}).text(function(t){return t.id+". "+t.label}).style("font-family",t.font_family).style("font-size","11px").on("mouseover",function(t,e){F(e),H(e)}).on("mouseout",function(t,e){G(e),J(e)}).call(O).each(function(){r+=d3.select(this).node().getBBox().height})}}function O(e){let n=0;e.each(function(){const e=d3.select(this),r=e.text().split(" ");let a=[];const l=`${e.text().split(".")[0]}. |`,o=e.append("tspan").text(l),i=e.append("tspan").text("|"),s=o.node().getComputedTextLength()-i.node().getComputedTextLength();e.text(null);let d=e.append("tspan").attr("x",0).attr("y",n).attr("dy",0);for(let n=0;n<r.length;n++)a.push(r[n]),d.text(a.join(" ")),d.node().getComputedTextLength()>t.legend_column_width&&1!==n&&(a.pop(),d.text(a.join(" ")),a=[r[n]],d=e.append("tspan").attr("x",s).attr("dy",t.legend_line_height).text(r[n]));const f=e.node().getBBox();n=f.y+f.height})}var $=E.append("g").attr("id","rink"),D=E.append("g").attr("id","bubble").attr("x",0).attr("y",0).style("opacity",0).style("pointer-events","none").style("user-select","none");function F(e){if(e.active||t.print_layout){var n=d3.select("#bubble text").text(e.label).node().getBBox();d3.select("#bubble").attr("transform",I(e.x-n.width/2,e.y-16)).style("opacity",.8),d3.select("#bubble rect").attr("x",-5).attr("y",-n.height).attr("width",n.width+10).attr("height",n.height+4),d3.select("#bubble path").attr("transform",I(n.width/2-5,3))}}function G(t){d3.select("#bubble").attr("transform",I(0,0)).style("opacity",0)}function H(t){var e=document.getElementById("legendItem"+t.id);e.setAttribute("filter","url(#solid)"),e.setAttribute("fill","white")}function J(t){var e=document.getElementById("legendItem"+t.id);e.removeAttribute("filter"),e.removeAttribute("fill")}D.append("rect").attr("rx",4).attr("ry",4).style("fill","#333"),D.append("text").style("font-family",t.font_family).style("font-size","10px").style("fill","#fff"),D.append("path").attr("d","M 0,0 10,0 5,8 z").style("fill","#333");var K,Q,R,U,V=$.selectAll(".blip").data(t.entries).enter().append("g").attr("class","blip").attr("transform",function(e,n){return S(e.quadrant,e.ring,t.legend_column_width,n)}).on("mouseover",function(t,e){F(e),H(e)}).on("mouseout",function(t,e){G(),J(e)});V.each(function(e){var n=d3.select(this);if(e.active&&Object.prototype.hasOwnProperty.call(e,"link")&&e.link&&(n=n.append("a").attr("xlink:href",e.link),t.links_in_new_tabs&&n.attr("target","_blank")),1==e.moved?n.append("path").attr("d","M -11,5 11,5 0,-13 z").style("fill",e.color):-1==e.moved?n.append("path").attr("d","M -11,-5 11,-5 0,13 z").style("fill",e.color):2==e.moved?n.append("path").attr("d",d3.symbol().type(d3.symbolStar).size(200)).style("fill",e.color):n.append("circle").attr("r",9).attr("fill",e.color),e.active||t.print_layout){var r=t.print_layout?e.id:e.label.match(/[a-z]/i);n.append("text").text(r).attr("y",3).attr("text-anchor","middle").style("fill","#fff").style("font-family",t.font_family).style("font-size",function(t){return r.length>2?"8px":"9px"}).style("pointer-events","none").style("user-select","none")}}),d3.forceSimulation().nodes(t.entries).velocityDecay(.19).force("collision",d3.forceCollide().radius(12).strength(.85)).on("tick",function(){V.attr("transform",function(t){return I(t.segment.clipx(t),t.segment.clipy(t))})}),t.print_ring_descriptions_table&&(K=d3.select("body").append("table").attr("class","radar-table").style("border-collapse","collapse").style("position","relative").style("top","-70px").style("margin-left","50px").style("margin-right","50px").style("font-family",t.font_family).style("font-size","13px").style("text-align","left"),Q=K.append("thead"),R=K.append("tbody"),U=100/t.rings.length+"%",Q.append("tr").style("border","1px solid #ddd").selectAll("th").data(t.rings).enter().append("th").style("padding","8px").style("border","1px solid #ddd").style("background-color",t=>t.color).style("color","#fff").style("width",U).text(t=>t.name),R.append("tr").style("border","1px solid #ddd").selectAll("td").data(t.rings).enter().append("td").style("padding","8px").style("border","1px solid #ddd").style("width",U).text(t=>t.description))}