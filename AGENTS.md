# Repository Guidelines

## Project Structure & Module Organization
Source code that powers `docs/radar.js` lives in `src/`, split into focused modules such as `math/`, `geometry/`, `processing/`, and `validation/`. Browser-ready artifacts, demo HTML, CSS, and release bundles live under `docs/`; edit `docs/index.html` for sample data or `docs/radar.css` for styling tweaks. Automation helpers (`scripts/build.ts`, `scripts/screenshot.ts`, auxiliary scripts/) stay in `scripts/`, while regression and exploratory specs live in `test/` (`test/vitest/` for Vitest suites, `test/unit/` for Bun-based checks). Static assets generated by CI, like coverage reports, should remain in their respective folders (`coverage/`, `test-results.xml`) so GitHub Pages workflows can pick them up.

## Build, Test, and Development Commands
- `bun install` – install dependencies defined in `package.json`.
- `bun start` – serve `/docs` with BrowserSync; auto-reloads when editing JS, HTML, or CSS.
- `bun run build` – run `scripts/build.ts` to minify `radar.js` and emit `docs/release/radar-*.js`.
- `bun run screenshot` – execute `scripts/screenshot.ts` to refresh example imagery.
- `bun test`, `bun run test` (Vitest) – execute the full test suite; prefer `bun run test:watch` while iterating and `bun run test:coverage` before opening a PR.

## Coding Style & Naming Conventions
Use modern ES modules with explicit file extensions and two-space indentation; favor `const` + pure helper functions in `src/math` and PascalCase classes (e.g., `EntryProcessor`). Match existing naming: quadrants/rings files use `*-calculator.js`, validators use `*-validator.js`, and global API remains a single `radar_visualization` export for browser consumers. Run `npm run lint:js` and `npm run lint:html` to enforce ESLint’s defaults plus `eslint-plugin-html` for embedded scripts. UI assets (`docs/*.css`) follow BEM-like class names; keep radar-specific selectors prefixed with `radar-` to avoid leaks.

## Testing Guidelines
Vitest (configured through `vitest.config.ts` and `test/vitest/`) covers geometry/math behavior using jsdom for DOM-dependent logic, while legacy Bun tests (`test/radar.test.js`) validate the bundled script. Add new specs beside the module under test (e.g., `src/geometry/__tests__/segment-calculator.vitest.js`), keep snapshot files deterministic by seeding `SeededRandom`, and mirror production scenarios in `test/unit/fixtures`. Codecov monitors branch coverage; maintain ≥90% coverage on changed files and include `bun run test:coverage` output in PR discussions when touching rendering logic.

## Commit & Pull Request Guidelines
Follow the conventional `type: summary` pattern seen in history (`feat:`, `refactor:`, `wip:`). Describe the scope succinctly, reference GitHub issues in the footer, and avoid lumping unrelated refactors with behavior changes. Pull requests should include: a concise summary, screenshots or preview URLs from the GitHub Pages preview workflow, testing notes (`bun run build`, `bun run test`), and any rollout considerations (data migrations, config updates). Confirm docs in `/docs` render locally before requesting review.

## Security & Configuration Tips
Do not commit credentials; radar content is static and should come from checked-in data. Keep `bunfig.toml` aligned with the Bun version used in CI, pin CDN links (e.g., d3 v7) when embedding in docs, and verify `docs/radar.js` remains self-contained so GitHub Pages deployments stay deterministic.
